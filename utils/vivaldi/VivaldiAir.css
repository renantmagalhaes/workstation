/* Vivaldi Air
https://raw.githubusercontent.com/MohamedxSalah/Vivaldi-Air/refs/heads/main/VivaldiAir.css
*/

:root {
  --customRadius: 8px; /* NOT USING NOW */

  --bgDark: rgba(0, 0, 0, 0.4);
  --bgLight: rgba(255, 255, 255, 0.4);

  --bgDisabledDark: rgba(0, 0, 0, 0.2);
  --bgDisabledLight: rgba(
    255,
    255,
    255,
    0.2
  );

  --blurLow: blur(4px);
  --blurMed: blur(6px);
  --blurMedHigh: blur(8px);
  --blurHigh: blur(12px);

  --hoverBlur: var(--blurMed);

  --anim-duration: 128ms;

  --space: 5px;
}

/* set theme-aware overlay */
.theme-dark {
  --bg: var(--bgDark);
  --bgDisabled: var(--bgDisabledDark);
}
.theme-light {
  --bg: var(--bgLight);
  --bgDisabled: var(--bgDisabledLight);
}

/* MAINBAR */

#browser.win.address-top
  .toolbar-mainbar:has(
    .window-buttongroup.on-mainbar
  ),
#browser.linux.address-top
  .toolbar-mainbar:has(
    .window-buttongroup.on-mainbar
  ) {
  min-height: calc(
    42px / var(--uiZoomLevel)
  );
}

.density-on .UrlBar-SearchField,
.density-on .UrlBar-AddressField {
  height: 34px;
}

.disable-titlebar#browser.win
  .window-buttongroup {
  height: 44px;
}

#browser.win
  .window-buttongroup
  button.window-close {
  border-top-right-radius: var(
    --radius
  );
  border-bottom-right-radius: var(
    --radius
  );
}

.mainbar {
  background-color: var(--bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  margin: 5px;
  border-radius: var(--radius);
}

.SearchField,
.UrlBar-AddressField {
  border: none !important;
  background-color: transparent;
}

.SearchField:hover,
.UrlBar-AddressField:hover,
.color-behind-tabs-on
  .SearchField:focus-within,
.color-behind-tabs-on
  .MailSearchField-Inner:focus-within,
.color-behind-tabs-on
  .UrlBar-AddressField:focus-within {
  background-color: var(--bg);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.UrlFragment-Wrapper--ShouldHighlight {
  --HighlightColor: var(--colorFg);
  --LowlightColor: var(--colorFg);
}

.address-top .mainbar {
  border-bottom: none;
}

.mainbar button:hover,
#browser:not(.tabs-top) .vivaldi:hover,
#browser:not(.tabs-top)
  .vivaldi:focus-visible,
.theme-dark#browser.win
  .window-buttongroup
  button:hover {
  background-color: var(--bg);
  backdrop-filter: var(--blurMed);
}

.disable-titlebar.address-top#browser:not(
    .tabs-top
  )
  .vivaldi {
  margin: 0 5px;
}

/* SIDEBAR */

#panels-container {
  margin-bottom: 5px;
  background-color: var(--bg);
  border-radius: var(--radius);
  min-width: 44px;
  position: relative;
  transition: width var(--anim-duration),
    margin-left var(--anim-duration)
      ease-out,
    min-width var(--anim-duration) !important;
}

/* Create backdrop blur with pseudo-element */
#panels-container::before {
  content: "";
  position: absolute;
  inset: 0;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-radius: var(--radius);
  pointer-events: none;
  z-index: -1;
}

#panels-container.overlay:not(.icons)
  .panel-group {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    12px
  ) !important;
  -webkit-backdrop-filter: blur(
    12px
  ) !important;
  border-radius: var(--radius);
  margin-left: 5px;
  margin-right: 5px;
}

#panels-container.left {
  margin-left: 5px;
}
#panels-container.right {
  margin-right: 5px;
}

#panels-container #switch {
  padding-bottom: 5px;
  min-width: 44px;
}

#panels-container.switcher {
  width: 0;
  min-width: 0;
  margin-left: 0;
  margin-right: 0;
  overflow: hidden;
}

/* doesnt disappear on collapse transition */
#panels-container.switcher #switch {
  visibility: none !important;
}

#panels {
  padding-bottom: 5px;
}

#panels
  .webpanel-stack
  .webpanel
  .webpanel-content {
  margin: 5px;
  margin-bottom: 0;
  border-radius: var(--radius);
}

#panels
  .webpanel-stack
  .webpanel
  .webpanel-header {
  box-shadow: none !important;
  padding-bottom: 0;
}

/* basic components */
#panels input,
#panels
  label:not(div.tree-row > label):not(
    .disabled
  ),
#panels textarea {
  background-color: var(--bg);
  border-radius: var(--radius);
  border: none;
  box-shadow: none;
}

#panels .sortselector {
  border: none !important;
  background-color: var(--bg);
}

#panels .sortselector-button {
  background-color: none !important;
  height: calc(
    var(--treeViewRowHeight) - 2px
  );
}

#panels
  #window-panel
  .vivaldi-tree
  .tree-row {
  background-color: var(
    --bg
  ) !important;
}

.panel-group .button-toolbar > button {
  background-color: var(
    --bg
  ) !important;
  background-image: none !important;
  border: none !important;
}
.panel-group
  .button-toolbar
  > button:disabled {
  background-color: var(
    --bgDisabled
  ) !important;
}

/* New note textbox */
.NotesEditor-Editor-Background:after {
  visibility: hidden;
}
.NotesEditor-EmptyPlaceholder:hover {
  background-color: var(--bg);
  outline: none;
  border-radius: var(--radius);
}

#panels-container.overlay .panel-group,
.ExtensionToggleIcon.ExtensionToggleIcon--Expanded,
.ExtensionIcon--Hidden {
  background-color: transparent;
}

#panels-container button:hover,
.ExtensionIcon--Hidden:hover,
.ExtensionIcon--Hidden:active,
.toolbar-panel
  > .button-toolbar
  > button.button-pressed,
.toolbar-panel
  .toolbar-extensions
  .button-toolbar
  > button.button-pressed,
.toolbar-panel
  .page-zoom-controls
  .button-toolbar
  > button.button-pressed,
.density-on
  #switch
  .addwebpanel-wrapper
  > button.active
  button,
.density-on
  #switch
  > .button-toolbar.active
  button,
.density-on
  #switch
  > *
  > .button-toolbar.active
  button,
.density-on
  #switch
  > button.active
  button {
  background-color: var(--bg);
  backdrop-filter: var(--blurMed);
}

/* STATUS BAR */
footer#footer {
  background: none !important;
  border-top: none !important;
}

footer .toolbar-statusbar {
  background-color: var(--bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  background-color: var(--bg);
  border-radius: var(--radius);
  margin: 0 5px 5px 5px;
}

.inner
  > .StatusInfo
  > .StatusInfo-Content {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurLow
  ) !important;
  -webkit-backdrop-filter: var(
    --blurLow
  ) !important;
  border-radius: var(
    --radius
  ) !important;
  padding-bottom: 5px !important;
  background-color: var(--bg);
  margin: 0 0 5px 13px !important;
  border: none !important;
}

/* ====================== */
/* UNIVERSAL WORKSPACES   */
/* ====================== */

/* Workspace buttons on tabbar (all positions) */
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > .button-toolbar,
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > div
  > .button-toolbar {
  color: var(--colorFg) !important;
  background: transparent !important;
}

/* Hover / active workspace button */
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > .button-toolbar
  > button:active,
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > div
  > .button-toolbar
  > button:active,
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > .button-toolbar:not(
    .toolbar-spacer,
    .toolbar-spacer-flexible
  )
  > button:not([disabled]):hover,
#tabs-tabbar-container
  .toolbar:not(.toolbar-small)
  > div
  > .button-toolbar:not(
    .toolbar-spacer,
    .toolbar-spacer-flexible
  )
  > button:not([disabled]):hover {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurMed
  ) !important;
  -webkit-backdrop-filter: var(
    --blurMed
  ) !important;
  border-radius: var(--radius);
}

/* Workspace popup container */
.button-popup.WorkspacePopup {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurHigh
  ) !important;
  -webkit-backdrop-filter: var(
    --blurHigh
  ) !important;
  border-radius: var(--radius);
  width: 194px;
  box-shadow: 0 2px 8px
    rgba(0, 0, 0, 0.3);
}

/* Workspace list items */
.WorkspacePopup-Items
  .workspace-item-wrapper,
.WorkspacePopup-Items .this-window {
  background-color: transparent !important;
  border-radius: var(--radius);
  margin-bottom: 3px;
  transition: background-color
    var(--anim-duration) ease;
}

/* Hover effect */
.WorkspacePopup-Items
  .workspace-item-wrapper:hover,
.WorkspacePopup-Items
  .this-window:hover {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurLow
  ) !important;
  -webkit-backdrop-filter: var(
    --blurLow
  ) !important;
}

/* Tab counter */
.WorkspacePopup-Items
  .workspace-item-wrapper
  .title
  .tab-count,
.WorkspacePopup-Items
  .this-window
  .title
  .tab-count {
  color: var(--colorFg) !important;
  font-weight: 500;
}

/* Popup padding adjustments */
.WorkspacePopup-Items {
  padding: 5px 5px 0 !important;
}
.WorkspacePopup .actions {
  padding: 0px 5px 5px !important;
}
.WorkspacePopup-Items hr {
  margin: 5px 0 1px !important;
}

/* Remove default arrow from popup */
.button-popup-right.button-popup-arrow-dark:before,
.button-popup-arrow-light:before {
  border-bottom-color: transparent !important;
}

/* Page tiling popup (consistent style) */
.button-popup.ToolbarButtonPopup-DefaultStyles {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurMed
  ) !important;
  -webkit-backdrop-filter: var(
    --blurMed
  ) !important;
  border-radius: var(--radius);
}
.button-popup.ToolbarButtonPopup-DefaultStyles
  h2 {
  background: transparent !important;
  border-bottom: none !important;
}

/* TABS */

#browser .tabbar-wrapper,
#browser.tabs-top #header {
  background-color: transparent;
}

#browser:not(.transparent-tabbar)
  #tabs-tabbar-container {
  background-color: var(--bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  margin: 5px 5px 0 5px;
  border-radius: var(--radius);
}

#titlebar {
  position: absolute;
  width: 100%;
  left: 5px;
  top: 5px;
  right: 0px;
  pointer-events: none;
}

#browser.win .window-buttongroup {
  position: absolute;
  right: 10px;
  top: 0;
  overflow: hidden;
  line-height: initial;
}

#browser.color-behind-tabs-on
  .tab.active.active,
#browser
  .tab-position.colored
  .tab.active,
#browser
  .tab-position.colored
  .tab:not(.active),
#browser
  .tab-position.colored.accordion-toggle-arrow {
  background-color: var(--bg);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* hover states */
#tabs-container
  .tab:not(
    .tab-group,
    .tab.active
  ):hover,
#browser
  .tab-position.colored.accordion-toggle-arrow:hover,
#browser
  .tab-position.colored
  .tab:not(.active):hover {
  background-color: var(--bg);
  backdrop-filter: var(--blurMed);
}

.tab.active .favicon {
  filter: none !important;
}

#browser
  .tab-position.colored
  .stack-counter {
  background-color: var(
    --colorHighlightBg
  );
}

/* INNER ROUND BORDERS */

#browser:not(.fullscreen)
  #webpage-stack {
  border-radius: var(--radius);
  margin: 0 5px 5px 5px;
}

/* ======================= */
/* Fullscreen gap killer   */
/* ======================= */
#browser.fullscreen,
#browser.fullscreen body,
#browser.fullscreen #header,
#browser.fullscreen #titlebar,
#browser.fullscreen #tabs-container,
#browser.fullscreen
  #tabs-tabbar-container,
#browser.fullscreen .mainbar,
#browser.fullscreen .bookmark-bar,
#browser.fullscreen #webpage-stack {
  margin: 0 !important;
  padding: 0 !important;
  top: 0 !important;
  min-height: 0 !important;
  height: auto !important;
  border: none !important;
}

/* SPEED DIAL */
.SpeedDial--Thumbnail {
  background-color: var(--bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  box-shadow: none;
}

/* CTRL+F */
.find-in-page-wrapper {
  background-color: var(--bg);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* Transparent active tab background */
.tab.active {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  transition: background-color 0.2s ease;
}
.tab.active::after {
  background: transparent !important;
}

/* BOOKMARK BAR */
.bookmark-bar {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    12px
  ) !important;
  -webkit-backdrop-filter: blur(
    12px
  ) !important;
  border-radius: var(--radius);
  margin: 4px;
  padding: 4px 8px;
  min-height: 30px !important;
  display: flex !important;
  align-items: center !important;
}

.bookmark-bar .observer {
  background: transparent !important;
}

.bookmark-bar button,
.bookmark-bar .button-toolbar > button,
.bookmark-bar .bookmark-item,
.bookmark-bar .bookmarkbar-item,
.bookmark-bar
  .toolbar
  > .button-toolbar
  > button {
  background-color: transparent !important;
  color: var(--colorFg) !important;
  border: none !important;
  border-radius: var(--radius);
  height: 30px !important;
  line-height: 30px !important;
  padding: 0 8px !important;
  display: inline-flex !important;
  align-items: center !important;
  transition: background-color 0.2s ease,
    backdrop-filter 0.2s ease,
    color 0.2s ease;
}

.bookmark-bar .button-title,
.bookmark-bar .title,
.bookmark-bar .bookmark-label {
  color: var(--colorFg) !important;
}

.bookmark-bar button:hover,
.bookmark-bar
  .button-toolbar
  > button:hover,
.bookmark-bar .bookmark-item:hover,
.bookmark-bar .bookmarkbar-item:hover {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    calc(var(--blurStrength) * 0.5)
  );
  -webkit-backdrop-filter: blur(
    calc(var(--blurStrength) * 0.5)
  );
}

.bookmark-bar button:active,
.bookmark-bar
  .button-toolbar
  > button:active,
.bookmark-bar .bookmark-item:active,
.bookmark-bar .bookmarkbar-item:active,
.bookmark-bar
  .button-toolbar
  > button[aria-pressed="true"] {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    calc(var(--blurStrength) * 0.7)
  );
  -webkit-backdrop-filter: blur(
    calc(var(--blurStrength) * 0.7)
  );
}

.bookmark-bar .separator {
  opacity: 0.5;
  border-right: 1px solid
    color-mix(
      in srgb,
      var(--colorFg),
      transparent 60%
    ) !important;
}

/* ========================================================= */
/* SPEED DIAL SEARCH BAR (blurred idle + consistent roundness) */
/* ========================================================= */

/* Idle blurred */
.startpage
  .SearchField:not(:hover):not(
    :focus-within
  ),
.StartPage
  .SearchField:not(:hover):not(
    :focus-within
  ),
.SpeedDial
  .SearchField:not(:hover):not(
    :focus-within
  ),
.SpeedDialView
  .SearchField:not(:hover):not(
    :focus-within
  ) {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurMed
  ) !important;
  -webkit-backdrop-filter: var(
    --blurMed
  ) !important;
  border-radius: var(
    --radius
  ) !important;
  box-shadow: none !important;
  transition: background-color 0.18s
      ease,
    backdrop-filter 0.18s ease;
}

/* Stronger blur when hovered/focused */
.startpage .SearchField:hover,
.startpage .SearchField:focus-within,
.StartPage .SearchField:hover,
.StartPage .SearchField:focus-within,
.SpeedDial .SearchField:hover,
.SpeedDial .SearchField:focus-within,
.SpeedDialView .SearchField:hover,
.SpeedDialView
  .SearchField:focus-within {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    12px
  ) !important;
  -webkit-backdrop-filter: blur(
    12px
  ) !important;
  border-radius: var(
    --radius
  ) !important; /* keep corners consistent */
}

/* Inner input transparency */
.startpage .SearchField input,
.StartPage .SearchField input,
.SpeedDial .SearchField input,
.SpeedDialView .SearchField input {
  background: transparent !important;
  color: inherit !important;
  border-radius: var(
    --radius
  ) !important;
}
.mainbar {
  z-index: 1; /* keep reasonable */
}

/* ========================================================= */
/* STARTPAGE NAVIGATION - THEME AWARE BLUR & BUTTON STYLING */
/* ========================================================= */

/* Config variables */
:root {
  --startpageNavBtnPrimary: var(
    --colorFg
  );
  --startpageNavBtnSecondary: var(
    --colorFg
  );
  --startpageNavBtnInactive: transparent;
  --startpageNavBtnRounding: 14px;
  --startpageNavBtnHeight: 23px;
  --startpageNavBtnMargin: 10px;
  --startpageNavPaddingOnTop: 10px; /* Vertical spacing */
  --startpageNavPaddingOnBottom: 10px; /* Vertical spacing */
  --startpageNavTextShadow: 0 0 2px
      var(--startpageNavBtnSecondary),
    0 0 3px
      var(--startpageNavBtnSecondary),
    0 0 5px
      var(--startpageNavBtnSecondary);
  --startpageNavIconShadow: drop-shadow(
    0 0 4px
      var(--startpageNavBtnSecondary)
  );

  /* Adaptive blur strength */
  --startpageNavBlur: 6px; /* default blur for nav bar */
  --startpageNavBlurStrong: 12px; /* blur for active/hover buttons */
}

/* Startpage Nav Bar container */
.startpage .startpage-navigation {
  background-color: var(--bg);
  backdrop-filter: blur(
    var(--startpageNavBlur)
  );
  -webkit-backdrop-filter: blur(
    var(--startpageNavBlur)
  );
  box-shadow: unset;
  padding-top: var(
    --startpageNavPaddingOnTop
  );
  padding-bottom: calc(
    var(--startpageNavPaddingOnBottom) -
      2px
  );
  min-height: unset;
  display: flex;
  justify-content: center;
  border-radius: var(--customRadius);
}

/* Folder nav buttons background */
.startpage
  .startpage-folder-navigation
  button {
  background-color: unset;
}

/* Startpage Nav Bar buttons */
.startpage
  .startpage-navigation
  .button-startpage,
.startpage
  .startpage-folder-navigation
  .button-startpage {
  display: flex;
  align-items: center;
  justify-content: center;
  height: var(--startpageNavBtnHeight);
  border-radius: var(
    --startpageNavBtnRounding
  ) !important;
  border: 1.2px solid
    var(--startpageNavBtnPrimary);
  background-color: var(
    --startpageNavBtnInactive
  );
  color: var(--startpageNavBtnPrimary);
  margin: 0 var(--startpageNavBtnMargin) !important;
  text-shadow: var(
    --startpageNavTextShadow
  );
  box-shadow: 0 0 2px 1px
    rgba(0, 0, 0, 0.2);
  transition: 0.2s ease;
  font-size: 11px;
  font-weight: 500;
}

/* Hover / active states with stronger blur */
.startpage
  .startpage-navigation
  .button-startpage.active,
.startpage
  .startpage-navigation
  .button-startpage:hover,
.startpage
  .startpage-folder-navigation
  .button-startpage:hover {
  color: var(
    --startpageNavBtnSecondary
  );
  background-color: var(
    --startpageNavBtnPrimary
  );
  text-shadow: 0 0 0.5px
    var(--startpageNavBtnSecondary);
  backdrop-filter: blur(
    var(--startpageNavBlurStrong)
  );
  -webkit-backdrop-filter: blur(
    var(--startpageNavBlurStrong)
  );
}

/* Icons styling */
.startpage
  .startpage-navigation
  .button-startpage
  svg,
.startpage
  .startpage-folder-navigation
  .button-startpage
  svg {
  color: var(--startpageNavBtnPrimary);
  filter: var(--startpageNavIconShadow);
  width: auto;
  height: 2.1em;
}

/* Hover / active icons */
.startpage
  .startpage-navigation
  .button-startpage.active
  svg,
.startpage
  .startpage-navigation
  .button-startpage:hover
  svg,
.startpage
  .startpage-folder-navigation
  .button-startpage:hover
  svg {
  color: var(
    --startpageNavBtnSecondary
  );
  filter: unset;
}

/* Folder back button adjustments */
button.button-startpage.up-level svg {
  position: unset;
  margin: 0 4px;
}
button.button-startpage.up-level span {
  display: flex;
}
.button-startpage.up-level {
  padding: 0 14px 0 6px;
}

/* Center folder navigation */
.startpage
  .startpage-folder-navigation {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Startpage widgets */
.Dashboard-Widgets .dashboard-widget {
  background-color: var(--bg);
  backdrop-filter: blur(
    12px
  ) !important;
}

/* Remove borders & extra styling */
.startpage
  .startpage-navigation
  .startpage-navigation-group:last-of-type {
  border: unset;
}
button.button-startpage:after {
  content: unset;
}

/* ========================================================= */
/* ADD / PLUS BUTTON FIXES */
/* ========================================================= */
.startpage
  .startpage-navigation
  .button-startpage.add-set {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 !important; /* remove extra padding */
  min-width: 27px; /* small width */
  height: var(
    --startpageNavBtnHeight
  ); /* match other buttons */
  border-radius: var(
    --startpageNavBtnRounding
  ) !important;
  background-color: var(
    --startpageNavBtnInactive
  );
  border: 1.2px solid
    var(--startpageNavBtnPrimary);
  margin: 0 var(--startpageNavBtnMargin) !important;
  text-shadow: var(
    --startpageNavTextShadow
  );
  box-shadow: 0 0 2px 1px
    rgba(0, 0, 0, 0.2);
  transition: 0.2s ease;
}

/* Center the SVG inside the add button */
.startpage
  .startpage-navigation
  .button-startpage.add-set
  svg {
  height: 16px;
  width: 16px;
  margin: 0;
  display: block;
}

/* Hover / active for add button */
.startpage
  .startpage-navigation
  .button-startpage.add-set:hover,
.startpage
  .startpage-navigation
  .button-startpage.add-set.active {
  background-color: var(
    --startpageNavBtnPrimary
  );
  color: var(
    --startpageNavBtnSecondary
  );
  backdrop-filter: blur(
    var(--startpageNavBlurStrong)
  );
  -webkit-backdrop-filter: blur(
    var(--startpageNavBlurStrong)
  );
}

.startpage
  .startpage-navigation
  .button-startpage.add-set:hover
  svg
  path,
.startpage
  .startpage-navigation
  .button-startpage.add-set.active
  svg
  path {
  fill: var(--startpageNavBtnSecondary);
}

/* Add folder button tweaks (keep min width for alignment) */
.startpage
  .startpage-navigation
  .button-startpage.add-set {
  padding-left: 1px;
  padding-right: 1px;
}

/* Speed dial items spacing fix */
.speeddial {
  margin-top: 0;
  padding-top: 2px;
}

/* Search bar spacing fix */
.sdwrapper
  .iconmenu-container.searchfield {
  margin: 0px auto 25px;
}

/* Notes icon scale */
.startpage
  .startpage-navigation
  .button-startpage[data-id="notes"]
  svg {
  transform: scale(1.45);
}

/* ========================================================= */
/* END STARTPAGE NAVIGATION */
/* ========================================================= */

/* =========================
   TWO-LEVEL TAB STACK: SUB-ROW
   ========================= */

/* Cover multiple builds/selectors for the sub strip */
#tabs-subcontainer,                                           /* common ID for sub-row */
#tabs-tabbar-container [aria-label="Tab Stack Toolbar"],      /* ARIA label on newer builds */
#tabs-tabbar-container .tabbar-wrapper + .tabbar-wrapper,     /* sub-row is injected as next wrapper */
#tabs-tabbar-container .tabbar-wrapper:has(.tab.is-sub),      /* fallback via :has */
#tabs-tabbar-container .tabbar-subcontainer {
  /* some snapshots used this class */
  background: var(--bg) !important;
  background-image: none !important; /* defeat Colored Tab Stacks paint */
  backdrop-filter: blur(
    12px
  ) !important;
  -webkit-backdrop-filter: blur(
    12px
  ) !important;
  border-radius: var(--radius);
  margin: 3px 5px 3px 5px; /* matches outer tab bar rounding */
}

/* Make tabs inside the sub-row look like normal tabs */
#tabs-subcontainer .tab,
#tabs-tabbar-container
  [aria-label="Tab Stack Toolbar"]
  .tab,
#tabs-tabbar-container
  .tabbar-wrapper
  + .tabbar-wrapper
  .tab,
#tabs-tabbar-container
  .tabbar-subcontainer
  .tab {
  background: transparent !important; /* let rowâ€™s blur show through */
}

#tabs-subcontainer
  .tab:not(.active):hover,
#tabs-tabbar-container
  [aria-label="Tab Stack Toolbar"]
  .tab:not(.active):hover,
#tabs-tabbar-container
  .tabbar-wrapper
  + .tabbar-wrapper
  .tab:not(.active):hover,
#tabs-tabbar-container
  .tabbar-subcontainer
  .tab:not(.active):hover {
  background: var(--bg) !important;
  backdrop-filter: var(
    --blurMed
  ) !important;
  -webkit-backdrop-filter: var(
    --blurMed
  ) !important;
}

/* Add padding inside parent tabbar */
#tabs-tabbar-container {
  padding-bottom: 6px !important;
}

/* Apply padding to the outer tabbar container when tabs are bottom */
#browser.tabs-bottom
  #tabs-tabbar-container {
  padding-top: 6px !important;
}

/* Bottom tabbar styling */
#browser.tabs-bottom:not(
    .transparent-tabbar
  )
  #tabs-tabbar-container {
  margin: 0 5px 5px 5px !important; /* adjust spacing for bottom */
  border-radius: var(
    --radius
  ) !important;
}

/* Remove the solid background behind the bottom bar */
#browser.tabs-bottom #footer {
  background: transparent !important;
}

/* add padding to bottom tabs when using tab stack */
#browser.tabs-bottom
  #tabs-tabbar-container {
  padding-bottom: 10px !important; /* default 5px + 5px extra gap */
}

/* ======================== */
/* FIX vertical tabs margin */
/* ======================== */

/* Left side */
.tabs-left #tabs-tabbar-container {
  margin-bottom: 5px !important;
  margin-right: 0px !important;
  margin-top: 0px !important;
}

/* Right side: use container instead */
.tabs-right #tabs-tabbar-container {
  margin-bottom: 5px !important;
  margin-left: 0px !important;
  margin-top: 0px !important;
}

/* ============================================= */
/* Fix missing margin between bottom and sidebar */
/* ============================================= */

#browser #panels-container.left,
#browser #panels-container.right {
  margin-bottom: 5px !important;
}

/* Collapse header/titlebar completely when tabs are hidden
   BUT keep it in popup/settings windows */

#browser.tabs-off
  #tabs-tabbar-container,
#browser.tabs-off #header {
  margin: 0 !important;
  padding: 0 !important;
}

/* ======================= */
/* Horizontal Menu Styling */
/* ======================= */

/* Make sure header/titlebar don't override */
#browser #header,
#browser #titlebar {
  background: transparent !important;
  box-shadow: none !important;
}

.menubar {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: blur(
    12px
  ) !important;
  -webkit-backdrop-filter: blur(
    12px
  ) !important;
  border-radius: var(
    --radius
  ) !important;
  margin: 4px;
  height: 28px !important;
  display: flex;
  align-items: center;
}

/* Menu items */
.menubar > .menuitem {
  color: var(--colorFg) !important;
  background: transparent !important;
  border-radius: var(--radius);
  padding: 0 10px !important;
  transition: background-color 0.2s ease,
    backdrop-filter 0.2s ease;
}

/* Hover */
.menubar > .menuitem:hover {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurMed
  ) !important;
}

/* Active / pressed state */
.menubar > .menuitem:active,
.menubar > .menuitem[open] {
  background-color: var(
    --bg
  ) !important;
  backdrop-filter: var(
    --blurMedHigh
  ) !important;
}

/* ============================ */
/* FIX History panel tree items */
/* ============================ */

#history-panel .vivaldi-tree .tree-row {
  background-color: transparent !important; /* Semi-transparent bg */
  backdrop-filter: var(
    --blurMed
  ) !important; /* Apply blur for glass effect */
  -webkit-backdrop-filter: var(
    --blurMed
  ) !important;
  transition: backdrop-filter
      var(--anim-duration) ease,
    background-color
      var(--anim-duration) ease;
}

/* === Fix: Bookmark bar to appear below the suggestions === */
.bookmark-bar {
  z-index: 0 !important;
}

/* =============================*/
/* Fix window buttons alignment */
/* ===========================]*/
#browser.win.tabs-left
  .window-buttongroup,
#browser.win.tabs-right
  .window-buttongroup,
#browser.win.tabs-off
  .window-buttongroup {
  right: 0px !important;
  margin-right: 0px !important;
}

/* ========================= */
/* FIX: Colored Tab Groups   */
/* ========================= */

/* Group title / text color */
#browser
  .tab-position.colored
  .tab-group-indicator,
#browser
  .tab-position.colored
  .tabbar-group-title {
  color: var(--colorFg) !important;
}

/* === Stack counter fix for both light & dark themes === */
#browser
  .tab-position.colored
  .stack-counter {
  background-color: var(
    --colorHighlightBg
  ) !important;
  color: var(
    --colorHighlightFg
  ) !important;
  font-weight: 600;
  border-radius: 10px;
  padding: 0 6px;
  min-width: 16px;
  text-align: center;
}

/* Ensure inactive tab group text stays theme-aware */
#browser
  .tab-position.colored
  .tab:not(.active)
  .tab-header {
  color: var(--colorFg) !important;
}

/* ---------------------------
   Fix: Address Bar inside Tab Bar (Vivaldi 7.6)
   --------------------------- */

/* Address & Search fields inside tab bar */
#tabs-tabbar-container
  .UrlBar
  .UrlBar-AddressField,
#tabs-tabbar-container
  .UrlBar
  .SearchField,
#tabs-tabbar-container
  .toolbar-mainbar
  .UrlBar-AddressField,
#tabs-tabbar-container
  .toolbar-mainbar
  .SearchField,
.tabbar-wrapper .UrlBar-AddressField,
.tabbar-wrapper .SearchField {
  background-color: var(
    --bg
  ) !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: var(
    --radius
  ) !important;
}

/* Ensure tab bar has proper stacking */
#tabs-tabbar-container {
  z-index: 1 !important;
  position: relative !important;
}

/* Force window controls to appear above tab bar */
.window-buttongroup {
  z-index: 1000 !important;
}

/* Force settings button to appear above tab bar */
.vivaldi,
.sidebar .button-toolbar.settings,
.button-settings {
  z-index: 1001 !important;
}

/* Ensure inner panel content respects sidebar radius */
#panels-container .panel-group,
#panels
  .webpanel-stack
  .webpanel
  .webpanel-content {
  border-radius: var(
    --radius
  ) !important;
  overflow: hidden;
}

/* ========================================================= */
/* END STARTPAGE NAVIGATION */
/* ========================================================= */
